<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>libdvfs: LibDVFS</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">libdvfs
   &#160;<span id="projectnumber">2.0</span>
   </div>
   <div id="projectbrief">A light library to set CPU governor and freqency</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.1.2 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li class="current"><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">LibDVFS </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="sec_intro"></a>
Introduction</h1>
<p>LibDVFS is intended to provide simple functions and structures to manipulate the CPU frequency.</p>
<p>Currently, the library allows controlling three different levels: the whole system, a DVFS unit, or a single core.</p>
<p>System and core levels exactly represent what you think they do. A DVFS unit is however a little bit more subbtle. In fact, on many processors, it is not possible to effectively set a different frequency on all the cores and some cores must run at the same frequency. All the cores that must run at the same frequency form a so-called DVFS unit. The frequency actually set to all the cores of a single DVFS unit is usually the maximal one among the frequencies requested by every cores in the unit.</p>
<p>In order to use the library, you only need to include <code><a class="el" href="libdvfs_8h.html" title="Libdvfs wrapper file to include in a project.">libdvfs/libdvfs.h</a></code>.</p>
<h1><a class="anchor" id="sec_supsys"></a>
Supported systems</h1>
<p>The library currently supports Linux operating systems with <code>cpufreq</code> installed and running.</p>
<h1><a class="anchor" id="sec_gov"></a>
Governors</h1>
<p>Linux uses governors to specify how it must control frequencies. Several options exist but the two options one has to be aware of is <code>ondemand</code> and <code>userspace</code>.</p>
<p>The <code>ondemand</code> governor ask Linux to automatically control frequencies. This is the default governor on Linux. The <code>userspace</code> governor ask Linux to let us control the frequencies. You must set this governor on the whole DVFS unit before changing the frequency of one of its core.</p>
<p>The governor used prior calling <code><a class="el" href="dvfs__context_8h.html#a779d179e7340e17577256005d02731e0" title="Starts controlling DVFS on the system.">dvfs_start()</a></code> is restored when <code><a class="el" href="dvfs__context_8h.html#a8759360cb2dd116d25d358b53094e649" title="Frees the memory associated to a DVFS context and restores the DVFS control to its state before calli...">dvfs_stop()</a></code> is called.</p>
<h1><a class="anchor" id="sec_errors"></a>
Errors handling</h1>
<p>Every function returns an error code. You can check it against <code>DVFS_SUCCESS</code> to determine if the function failed or not. <code><a class="el" href="dvfs__error_8h.html#a63994a35b8bf04e23d2bcdc67bf87f72" title="Returns a string describing the error number.">dvfs_strerror()</a></code> can be used to get a human readable error string.</p>
<h1><a class="anchor" id="sec_install"></a>
Compilation and installation</h1>
<p>The library has no external dependcy, you can compile it using the <code>make</code> command. You will need a standard C compilation tool-chain (make and GCC for instance).</p>
<p>You can install the library using <code>make</code> <code>install</code>. Moreover, you can set the following environment variables <code>PREFIX</code>, <code>INCLUDE_DIR</code> and <code>LIB_DIR</code> to modify where the library will be installed.</p>
<dl class="section warning"><dt>Warning</dt><dd>In order to be able to control the frequencies, you need to be able to write to various files (<code>cpufreq_setspeed</code>, <code>cpufreq_governor</code>) in <code>/sys/devices/system/cpu*/cpu/cpufreq/</code> and to read in most of the other files within the same directory.</dd></dl>
<h1><a class="anchor" id="sec_ex"></a>
Example</h1>
<p>The library provides a few tests that can be used to better understand how to use the library.</p>
<h2><a class="anchor" id="ssec_core"></a>
Controlling a single core</h2>
<p>In order to control a single core, you need to perform the following operations: </p>
<ul>
<li>Start the library using <code><a class="el" href="dvfs__context_8h.html#a779d179e7340e17577256005d02731e0" title="Starts controlling DVFS on the system.">dvfs_start()</a></code> </li>
<li>Get the DVFS unit in charge of the core you want to control (<code><a class="el" href="dvfs__context_8h.html#a053ffc6d79985818fed790d4768db2d9" title="Gets the DVFS unit associated to the given index.">dvfs_get_unit_by_id()</a></code> or <code><a class="el" href="dvfs__context_8h.html#ae7da305dbce4e9d38ba307decb7b6fe2" title="Gets the DVFS unit associated with the given core.">dvfs_get_unit_by_core()</a></code>) </li>
<li>Sets the <code>userspace</code> governor on it (<code><a class="el" href="dvfs__unit_8h.html#a4324ea1d90c229e9d363acd567e45714" title="Sets a governor on all the cores we are in charge of.">dvfs_unit_set_gov()</a></code>) </li>
<li>Sets the core frequency (<code><a class="el" href="dvfs__core_8h.html#ab58c530cf1482e295637ebc4bf857a54" title="Sets the frequency for the given core.">dvfs_core_set_freq()</a></code>).</li>
</ul>
<dl class="section warning"><dt>Warning</dt><dd>This only sets the core frequency but, if any core on the same DVFS unit requests an higher frequency, it will overwrite our request. If you want to make sure that the desired frequency is applied to your core, you should apply it to the whole DVFS unit using <code><a class="el" href="dvfs__unit_8h.html#a4dc84c1671c5ec6b3a15c63755da87e6" title="Sets the given frequency on all the unit cores.">dvfs_unit_set_freq()</a></code>.</dd></dl>
<h2><a class="anchor" id="ssec_cpu"></a>
Controlling the whole system</h2>
<p>A similar procedure can be used to control all the cores at the same time. The functions <code><a class="el" href="dvfs__context_8h.html#aae8a1d64cefcf9202d31ffff09c34d7c" title="Sets the provided governor on all the DVFS units.">dvfs_set_gov()</a></code> and <code><a class="el" href="dvfs__context_8h.html#ae861c2868b0f5284582a4fc6d5b6f719" title="Sets the given frequency on all the DVFS units.">dvfs_set_freq()</a></code> can be used for that purpose. Have a look to <code>test_cpu</code> and <code>test_core</code> to see how to use the library. </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Aug 11 2014 16:39:12 for libdvfs by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.1.2
</small></address>
</body>
</html>
